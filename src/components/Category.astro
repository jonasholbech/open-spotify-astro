---
import Playlist from "./Playlist.astro";
const { title } = Astro.props;
---

<article>
  <header>
    <h2>{title}</h2>
    <a href="#/seeall">Show all</a>
  </header>
  <section class="playlists">
    <Playlist color="yellow" cover="0006.jpg" title="Peacefull Piano">
      Relax and indulge with beautiful piano pieces
    </Playlist>
    <Playlist color="hotpink" cover="0007.jpg" title="Peacefull Piano">
      Relax and indulge with beautiful piano pieces
    </Playlist>
    <Playlist color="#fff" cover="0008.jpg" title="Peacefull Piano">
      Relax and indulge with beautiful piano pieces
    </Playlist>
    <Playlist color="royalblue" cover="0009.jpg" title="Peacefull Piano">
      Relax and indulge with beautiful piano pieces
    </Playlist>
    <Playlist color="hsl(50 80% 100%)" cover="0005.jpg" title="Peacefull Piano">
      Relax and indulge with beautiful piano pieces
    </Playlist>
    <Playlist color="hotpink" cover="0010.jpg" title="Peacefull Piano">
      Relax and indulge with beautiful piano pieces
    </Playlist>
  </section>
</article>

<script>
  let timeoutId = null;
  function toggleOnResize() {
    console.log("called");
    const a = document.querySelectorAll(".playlists");
    const dimensions = a[0].getBoundingClientRect();
    const amountAllowed = Math.floor(dimensions.width / (180 + 16));
    a.forEach((list) => {
      const children = list.querySelectorAll("article");
      for (let i = 0; i < children.length; i++) {
        if (i >= amountAllowed) {
          children[i].style.display = "none";
        } else {
          children[i].style.display = "initial";
        }
      }
    });
  }
  toggleOnResize();
  function throttle() {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(toggleOnResize, 100);
  }
  window.addEventListener("resize", throttle);
</script>
<style>
  article {
    margin-bottom: 2rem;
    overflow: hidden;
  }
  h2 {
    margin: 0;
  }
  header {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    margin-bottom: 1rem;
  }
  .playlists {
    display: flex;
    max-width: calc(100vw - 270px);
    overflow-x: hidden;
    gap: 1rem;
  }
</style>
